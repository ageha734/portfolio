#!/usr/bin/env bun
// @bun
import{existsSync as v,readFileSync as g}from"node:fs";import{resolve as m}from"node:path";import{$ as f}from"bun";var c="portfolio";function p(){let t=process.argv.slice(2),e=t[0]||"production",o=t[1]||".env";return{environment:e,envFile:o}}function d(t){let e=t.trim();if(!e||e.startsWith("#"))return null;let r=/^([A-Za-z_]\w*)=(.*)$/.exec(e);if(!r)return null;let s=r[1],i=r[2];if(!s||i===void 0)return null;let n=i;if(n.startsWith('"')&&n.endsWith('"')||n.startsWith("'")&&n.endsWith("'"))n=n.slice(1,-1);return{key:s,value:n}}async function h(t,e){try{return await f`echo ${e} | wrangler pages secret put ${t} --project-name ${c}`.quiet(),!0}catch{return!1}}async function a(){let{environment:t,envFile:e}=p(),o=m(process.cwd(),e);if(!v(o))console.error(`Error: ${e} not found`),process.exit(1);console.log(`\uD83D\uDCE6 Importing environment variables from ${e} to Cloudflare Pages (${t})...`),console.log("");let s=g(o,"utf-8").split(`
`);for(let i of s){let n=d(i);if(!n)continue;let{key:l,value:u}=n;if(l.startsWith("VITE_")){if(console.log(`  Setting ${l}...`),!await h(l,u))console.log(`    ⚠️  Failed to set ${l} (may require interactive login)`)}}console.log(""),console.log("✅ Environment variables import completed!"),console.log(""),console.log("Note: To view or manage secrets, visit:"),console.log(`  https://dash.cloudflare.com/ > Workers & Pages > ${c} > Settings > Environment variables`)}a();
