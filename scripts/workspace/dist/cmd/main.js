#!/usr/bin/env bun
// @bun
var Tn=Object.create;var{getPrototypeOf:In,defineProperty:_,getOwnPropertyNames:qn}=Object;var jn=Object.prototype.hasOwnProperty;var L=(n,t,e)=>{e=n!=null?Tn(In(n)):{};let s=t||!n||!n.__esModule?_(e,"default",{value:n,enumerable:!0}):e;for(let i of qn(n))if(!jn.call(s,i))_(s,i,{get:()=>n[i],enumerable:!0});return s};var Un=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports);var B=(n,t)=>{for(var e in t)_(n,e,{get:t[e],enumerable:!0,configurable:!0,set:(s)=>t[e]=()=>s})};var y=(n,t)=>()=>(n&&(t=n(n=0)),t);var U=Un((Lt,j)=>{var M=process||{},ln=M.argv||[],$=M.env||{},Xn=!(!!$.NO_COLOR||ln.includes("--no-color"))&&(!!$.FORCE_COLOR||ln.includes("--color")||M.platform==="win32"||(M.stdout||{}).isTTY&&$.TERM!=="dumb"||!!$.CI),Zn=(n,t,e=n)=>(s)=>{let i=""+s,o=i.indexOf(t,n.length);return~o?n+Nn(i,t,e,o)+t:n+i+t},Nn=(n,t,e,s)=>{let i="",o=0;do i+=n.substring(o,s)+e,o=s+t.length,s=n.indexOf(t,o);while(~s);return i+n.substring(o)},cn=(n=Xn)=>{let t=n?Zn:()=>String;return{isColorSupported:n,reset:t("\x1B[0m","\x1B[0m"),bold:t("\x1B[1m","\x1B[22m","\x1B[22m\x1B[1m"),dim:t("\x1B[2m","\x1B[22m","\x1B[22m\x1B[2m"),italic:t("\x1B[3m","\x1B[23m"),underline:t("\x1B[4m","\x1B[24m"),inverse:t("\x1B[7m","\x1B[27m"),hidden:t("\x1B[8m","\x1B[28m"),strikethrough:t("\x1B[9m","\x1B[29m"),black:t("\x1B[30m","\x1B[39m"),red:t("\x1B[31m","\x1B[39m"),green:t("\x1B[32m","\x1B[39m"),yellow:t("\x1B[33m","\x1B[39m"),blue:t("\x1B[34m","\x1B[39m"),magenta:t("\x1B[35m","\x1B[39m"),cyan:t("\x1B[36m","\x1B[39m"),white:t("\x1B[37m","\x1B[39m"),gray:t("\x1B[90m","\x1B[39m"),bgBlack:t("\x1B[40m","\x1B[49m"),bgRed:t("\x1B[41m","\x1B[49m"),bgGreen:t("\x1B[42m","\x1B[49m"),bgYellow:t("\x1B[43m","\x1B[49m"),bgBlue:t("\x1B[44m","\x1B[49m"),bgMagenta:t("\x1B[45m","\x1B[49m"),bgCyan:t("\x1B[46m","\x1B[49m"),bgWhite:t("\x1B[47m","\x1B[49m"),blackBright:t("\x1B[90m","\x1B[39m"),redBright:t("\x1B[91m","\x1B[39m"),greenBright:t("\x1B[92m","\x1B[39m"),yellowBright:t("\x1B[93m","\x1B[39m"),blueBright:t("\x1B[94m","\x1B[39m"),magentaBright:t("\x1B[95m","\x1B[39m"),cyanBright:t("\x1B[96m","\x1B[39m"),whiteBright:t("\x1B[97m","\x1B[39m"),bgBlackBright:t("\x1B[100m","\x1B[49m"),bgRedBright:t("\x1B[101m","\x1B[49m"),bgGreenBright:t("\x1B[102m","\x1B[49m"),bgYellowBright:t("\x1B[103m","\x1B[49m"),bgBlueBright:t("\x1B[104m","\x1B[49m"),bgMagentaBright:t("\x1B[105m","\x1B[49m"),bgCyanBright:t("\x1B[106m","\x1B[49m"),bgWhiteBright:t("\x1B[107m","\x1B[49m")}};j.exports=cn();j.exports.createColors=cn});var mn={};B(mn,{setupEnvFile:()=>F,logSubStep:()=>c,logStep:()=>d,logSection:()=>x,LoadingBar:()=>p});import{copyFileSync as Ln,existsSync as an,writeFileSync as Bn}from"fs";import{join as un}from"path";function x(n){console.log(),console.log(b.default.bold(b.default.cyan(`  ${n}`))),console.log(b.default.dim(`  ${"\u2500".repeat(50)}`))}function d(n,t,e="info"){let s={info:b.default.blue,success:b.default.green,warning:b.default.yellow,error:b.default.red},i;if(e==="success")i="\u2713";else if(e==="error")i="\u2717";else if(e==="warning")i="\u26A0";else i="\u2192";console.log(`  ${s[e](i)} ${n} ${t}`)}function c(n,t="info"){let e={info:b.default.dim,success:b.default.green,warning:b.default.yellow},s;if(t==="success")s="\u2713";else if(t==="warning")s="\u26A0";else s="  ";console.log(`    ${e[t](s)} ${n}`)}class p{message;interval=null;frames=["\u280B","\u2819","\u2839","\u2838","\u283C","\u2834","\u2826","\u2827","\u2807","\u280F"];frameIndex=0;isActive=!1;constructor(n){this.message=n}start(){if(this.isActive)return;this.isActive=!0,this.frameIndex=0,this.interval=setInterval(()=>{let n=this.frames[this.frameIndex%this.frames.length];process.stdout.write(`\r    ${b.default.cyan(n)} ${b.default.dim(this.message)}`),this.frameIndex++},100)}stop(n=!0,t){if(!this.isActive)return;if(this.isActive=!1,this.interval)clearInterval(this.interval),this.interval=null;if(process.stdout.write(`\r${" ".repeat(80)}\r`),t)c(t,n?"success":"warning")}}async function F(n){x("\uD83D\uDCDD \u74B0\u5883\u8A2D\u5B9A");let t=un(n,".env.example"),e=un(n,".env");if(an(e)){d("",".env\u30D5\u30A1\u30A4\u30EB\u306F\u65E2\u306B\u5B58\u5728\u3057\u307E\u3059","success");return}if(an(t))d("\uD83D\uDCDD",".env.example\u304B\u3089.env\u30D5\u30A1\u30A4\u30EB\u3092\u4F5C\u6210\u3057\u3066\u3044\u307E\u3059...","info"),Ln(t,e),d("",".env\u30D5\u30A1\u30A4\u30EB\u3092\u4F5C\u6210\u3057\u307E\u3057\u305F","success");else d("\u26A0\uFE0F",".env.example\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3002\u7A7A\u306E.env\u30D5\u30A1\u30A4\u30EB\u3092\u4F5C\u6210\u3057\u307E\u3059...","warning"),Bn(e,`# Environment variables
`),d("","\u7A7A\u306E.env\u30D5\u30A1\u30A4\u30EB\u3092\u4F5C\u6210\u3057\u307E\u3057\u305F","success")}var b;var v=y(()=>{b=L(U(),1)});var{$:g}=globalThis.Bun;import{existsSync as Q}from"fs";import{join as C}from"path";async function fn(){try{return await g`docker --version`.quiet(),!0}catch{return!1}}async function hn(n){try{return(await g`docker ps -a --filter name=^${n}$ --format {{.Names}}`.quiet()).stdout.toString().trim()===n}catch{return!1}}async function pn(n){try{return(await g`docker ps --filter name=^${n}$ --format {{.Names}}`.quiet()).stdout.toString().trim()===n}catch{return!1}}async function Y(n){try{return(await g`docker images --format {{.Repository}}:{{.Tag}}`.quiet()).stdout.toString().trim().split(`
`).some((s)=>s.startsWith(`${n}:`)||s===n)}catch{return!1}}async function Dn(n,t,e){let s=new p("MySQL Docker\u30A4\u30E1\u30FC\u30B8\u3092\u30D3\u30EB\u30C9\u3057\u3066\u3044\u307E\u3059");s.start();try{await g`docker build -t db -f ${t} ${e}`.cwd(n).quiet(),s.stop(!0,"MySQL Docker\u30A4\u30E1\u30FC\u30B8\u306E\u30D3\u30EB\u30C9\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F")}catch(i){throw s.stop(!1,"MySQL Docker\u30A4\u30E1\u30FC\u30B8\u306E\u30D3\u30EB\u30C9\u306B\u5931\u6557\u3057\u307E\u3057\u305F"),i}}async function nt(n,t,e){c("MySQL Docker\u30A4\u30E1\u30FC\u30B8\u3092\u30D3\u30EB\u30C9\u3057\u3066\u3044\u307E\u3059...","info");try{await g`docker build -t db -f ${t} ${e}`.cwd(n).quiet(),c("MySQL Docker\u30A4\u30E1\u30FC\u30B8\u306E\u30D3\u30EB\u30C9\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F","success")}catch(s){throw c("MySQL Docker\u30A4\u30E1\u30FC\u30B8\u306E\u30D3\u30EB\u30C9\u306B\u5931\u6557\u3057\u307E\u3057\u305F","warning"),s}}async function tt(n,t){let e=new p("E2E\u7528Docker\u30A4\u30E1\u30FC\u30B8\u3092\u30D3\u30EB\u30C9\u3057\u3066\u3044\u307E\u3059");e.start();try{await g`docker build -t e2e -f ${t} .`.cwd(n).quiet(),e.stop(!0,"E2E\u7528Docker\u30A4\u30E1\u30FC\u30B8\u306E\u30D3\u30EB\u30C9\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F")}catch(s){throw e.stop(!1,"E2E\u7528Docker\u30A4\u30E1\u30FC\u30B8\u306E\u30D3\u30EB\u30C9\u306B\u5931\u6557\u3057\u307E\u3057\u305F"),s}}async function et(n,t){c("E2E\u7528Docker\u30A4\u30E1\u30FC\u30B8\u3092\u30D3\u30EB\u30C9\u3057\u3066\u3044\u307E\u3059...","info");try{await g`docker build -t e2e -f ${t} .`.cwd(n).quiet(),c("E2E\u7528Docker\u30A4\u30E1\u30FC\u30B8\u306E\u30D3\u30EB\u30C9\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F","success")}catch(e){throw c("E2E\u7528Docker\u30A4\u30E1\u30FC\u30B8\u306E\u30D3\u30EB\u30C9\u306B\u5931\u6557\u3057\u307E\u3057\u305F","warning"),e}}async function st(n,t,e){let s=new p("Redis Docker\u30A4\u30E1\u30FC\u30B8\u3092\u30D3\u30EB\u30C9\u3057\u3066\u3044\u307E\u3059");s.start();try{await g`docker build -t cache -f ${t} ${e}`.cwd(n).quiet(),s.stop(!0,"Redis Docker\u30A4\u30E1\u30FC\u30B8\u306E\u30D3\u30EB\u30C9\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F")}catch(i){throw s.stop(!1,"Redis Docker\u30A4\u30E1\u30FC\u30B8\u306E\u30D3\u30EB\u30C9\u306B\u5931\u6557\u3057\u307E\u3057\u305F"),i}}async function it(n,t,e){c("Redis Docker\u30A4\u30E1\u30FC\u30B8\u3092\u30D3\u30EB\u30C9\u3057\u3066\u3044\u307E\u3059...","info");try{await g`docker build -t cache -f ${t} ${e}`.cwd(n).quiet(),c("Redis Docker\u30A4\u30E1\u30FC\u30B8\u306E\u30D3\u30EB\u30C9\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F","success")}catch(s){throw c("Redis Docker\u30A4\u30E1\u30FC\u30B8\u306E\u30D3\u30EB\u30C9\u306B\u5931\u6557\u3057\u307E\u3057\u305F","warning"),s}}async function ot(n,t){try{return(await g`docker exec -e MYSQL_PWD=${t} ${n} mysqladmin ping -h localhost -u root`.quiet()).exitCode===0}catch{return!1}}async function rt(n,t){try{return(await g`docker exec ${n} redis-cli -a ${t} ping`.quiet()).stdout.toString().trim()==="PONG"}catch{return!1}}function S(n,t,e){if(n)n.stop(t,e);else c(e,t?"success":"warning")}async function lt(n,t,e){for(let s=0;s<e;s++){if(await ot(n,t))return!0;await new Promise((o)=>setTimeout(o,1000))}return!1}async function V(n,t=!0,e=30){let s=process.env.MYSQL_ROOT_PASSWORD||"rootpassword",i=t?new p("MySQL\u306E\u8D77\u52D5\u3092\u5F85\u6A5F\u3057\u3066\u3044\u307E\u3059"):null;if(i)i.start();try{if(await lt(n,s,e))return S(i,!0,"MySQL\u304C\u8D77\u52D5\u3057\u307E\u3057\u305F"),!0;return S(i,!1,"MySQL\u306E\u8D77\u52D5\u78BA\u8A8D\u304C\u30BF\u30A4\u30E0\u30A2\u30A6\u30C8\u3057\u307E\u3057\u305F"),!1}catch{return S(i,!1,"MySQL\u306E\u8D77\u52D5\u78BA\u8A8D\u306B\u5931\u6557\u3057\u307E\u3057\u305F"),!1}}async function ct(n,t,e){for(let s=0;s<e;s++){if(await rt(n,t))return!0;await new Promise((o)=>setTimeout(o,1000))}return!1}async function P(n,t=!0,e=30){let s=process.env.REDIS_PASSWORD||"password",i=t?new p("Redis\u306E\u8D77\u52D5\u3092\u5F85\u6A5F\u3057\u3066\u3044\u307E\u3059"):null;if(i)i.start();try{if(await ct(n,s,e))return S(i,!0,"Redis\u304C\u8D77\u52D5\u3057\u307E\u3057\u305F"),!0;return S(i,!1,"Redis\u306E\u8D77\u52D5\u78BA\u8A8D\u304C\u30BF\u30A4\u30E0\u30A2\u30A6\u30C8\u3057\u307E\u3057\u305F"),!1}catch{return S(i,!1,"Redis\u306E\u8D77\u52D5\u78BA\u8A8D\u306B\u5931\u6557\u3057\u307E\u3057\u305F"),!1}}async function at(n,t,e){if(await pn(n)){c("MySQL\u30B3\u30F3\u30C6\u30CA\u306F\u65E2\u306B\u8D77\u52D5\u3057\u3066\u3044\u307E\u3059","success"),await V(n,e);return}c("MySQL\u30B3\u30F3\u30C6\u30CA\u3092\u8D77\u52D5\u3057\u3066\u3044\u307E\u3059...","info"),await g`docker start ${n}`.cwd(t).quiet(),await V(n,e)}async function ut(n,t,e){c("MySQL\u30B3\u30F3\u30C6\u30CA\u3092\u4F5C\u6210\u3057\u3066\u8D77\u52D5\u3057\u3066\u3044\u307E\u3059...","info");let s=process.env.MYSQL_ROOT_PASSWORD||"rootpassword",i=process.env.MYSQL_DATABASE||"portfolio",o=process.env.MYSQL_USER||"user",a=process.env.MYSQL_PASSWORD||"password";if(await g`docker run -d \
        --name ${n} \
        -p 3306:3306 \
        -e MYSQL_ROOT_PASSWORD=${s} \
        -e MYSQL_DATABASE=${i} \
        -e MYSQL_USER=${o} \
        -e MYSQL_PASSWORD=${a} \
        -v db-data:/var/lib/mysql \
        db`.cwd(t).quiet(),c("MySQL\u30B3\u30F3\u30C6\u30CA\u304C\u8D77\u52D5\u3057\u307E\u3057\u305F","success"),!await V(n,e))c("MySQL\u306E\u8D77\u52D5\u78BA\u8A8D\u304C\u30BF\u30A4\u30E0\u30A2\u30A6\u30C8\u3057\u307E\u3057\u305F","warning")}async function mt(n,t,e){if(await pn(n)){c("Redis\u30B3\u30F3\u30C6\u30CA\u306F\u65E2\u306B\u8D77\u52D5\u3057\u3066\u3044\u307E\u3059","success"),await P(n,e);return}c("Redis\u30B3\u30F3\u30C6\u30CA\u3092\u8D77\u52D5\u3057\u3066\u3044\u307E\u3059...","info"),await g`docker start ${n}`.cwd(t).quiet(),await P(n,e)}async function ft(n,t,e){c("Redis\u30B3\u30F3\u30C6\u30CA\u3092\u4F5C\u6210\u3057\u3066\u8D77\u52D5\u3057\u3066\u3044\u307E\u3059...","info");let s=process.env.REDIS_PASSWORD||"password";if(await g`docker run -d \
        --name ${n} \
        -p 6379:6379 \
        -e REDIS_PASSWORD=${s} \
        -v cache-data:/data \
        cache`.cwd(t).quiet(),c("Redis\u30B3\u30F3\u30C6\u30CA\u304C\u8D77\u52D5\u3057\u307E\u3057\u305F","success"),!await P(n,e))c("Redis\u306E\u8D77\u52D5\u78BA\u8A8D\u304C\u30BF\u30A4\u30E0\u30A2\u30A6\u30C8\u3057\u307E\u3057\u305F","warning")}async function ht(n,t=!0){let s=C(n,".docker/db"),i=C(s,"Dockerfile");if(!Q(i)){c("MySQL Dockerfile\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093","warning");return}try{if(!await fn()){c("Docker\u304C\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3055\u308C\u3066\u3044\u307E\u305B\u3093","warning");return}if(await Y("db"))c("MySQL Docker\u30A4\u30E1\u30FC\u30B8\u306F\u65E2\u306B\u5B58\u5728\u3057\u307E\u3059","success");else if(t)await Dn(n,i,s);else await nt(n,i,s);if(await hn("db")){await at("db",n,t);return}await ut("db",n,t)}catch(o){if(c("MySQL\u30B3\u30F3\u30C6\u30CA\u306E\u8D77\u52D5\u306B\u5931\u6557\u3057\u307E\u3057\u305F","warning"),process.env.DEBUG)console.error(o)}}async function pt(n,t=!0){let s=C(n,".docker/cache"),i=C(s,"Dockerfile");if(!Q(i)){c("Redis Dockerfile\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093","warning");return}try{if(!await fn()){c("Docker\u304C\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3055\u308C\u3066\u3044\u307E\u305B\u3093","warning");return}if(await Y("cache"))c("Redis Docker\u30A4\u30E1\u30FC\u30B8\u306F\u65E2\u306B\u5B58\u5728\u3057\u307E\u3059","success");else if(t)await st(n,i,s);else await it(n,i,s);if(await hn("cache")){await mt("cache",n,t);return}await ft("cache",n,t)}catch(o){if(c("Redis\u30B3\u30F3\u30C6\u30CA\u306E\u8D77\u52D5\u306B\u5931\u6557\u3057\u307E\u3057\u305F","warning"),process.env.DEBUG)console.error(o)}}async function G(n,t=!0){x("\uD83D\uDC33 Docker\u30A4\u30E1\u30FC\u30B8\u306E\u30D3\u30EB\u30C9");let e=C(n,".docker/e2e/Dockerfile");if(Q(e))try{if(await Y("e2e"))c("E2E\u7528Docker\u30A4\u30E1\u30FC\u30B8\u306F\u65E2\u306B\u5B58\u5728\u3057\u307E\u3059","success");else if(t)await tt(n,e);else await et(n,e)}catch(s){if(c("E2E\u7528Docker\u30A4\u30E1\u30FC\u30B8\u306E\u30D3\u30EB\u30C9\u306B\u5931\u6557\u3057\u307E\u3057\u305F","warning"),process.env.DEBUG)console.error(s)}await ht(n,t),await pt(n,t)}var gn=y(()=>{v()});var{$:gt}=globalThis.Bun;async function dn(n){x("\uD83D\uDCE6 \u4F9D\u5B58\u95A2\u4FC2\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB");let t=new p("\u4F9D\u5B58\u95A2\u4FC2\u3092\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3057\u3066\u3044\u307E\u3059");t.start();try{await gt`bun install --ignore-scripts`.cwd(n).quiet(),t.stop(!0,"\u4F9D\u5B58\u95A2\u4FC2\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F")}catch(e){if(t.stop(!1,"\u4F9D\u5B58\u95A2\u4FC2\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u306B\u5931\u6557\u3057\u307E\u3057\u305F"),process.env.DEBUG)console.error(e);throw e}}var bn=y(()=>{v()});var{$:W}=globalThis.Bun;import{existsSync as dt,readFileSync as bt,writeFileSync as xn}from"fs";import{join as H}from"path";async function yt(n){try{return(await W`docker ps --filter name=^${n}$ --format {{.Names}}`.quiet()).stdout.toString().trim()===n}catch{return!1}}function St(n){let t=n,e=t?.stderr?.toString()??t?.message??String(n);return xt.exec(e)?.[1]?.trim()??null}function Ot(n){return n.length>80?`${n.substring(0,77)}...`:n}function Ct(n){let t=n,e=t?.stderr?.toString()??t?.stdout?.toString()??t?.message??String(n);return vt.some((s)=>s.test(e))}function wn(n,t){if(Ct(n))t.stop(!0,"\u30C7\u30FC\u30BF\u30D9\u30FC\u30B9\u30DE\u30A4\u30B0\u30EC\u30FC\u30B7\u30E7\u30F3\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F\uFF08\u4E00\u90E8\u306E\u8B66\u544A\u3042\u308A\uFF09");else t.stop(!1,"\u30C7\u30FC\u30BF\u30D9\u30FC\u30B9\u30DE\u30A4\u30B0\u30EC\u30FC\u30B7\u30E7\u30F3\u306B\u5931\u6557\u3057\u307E\u3057\u305F");if(process.env.DEBUG){console.error(n);return}let s=St(n);if(s)c(Ot(s),"warning")}function Et(){let n=process.env.MYSQL_USER||"user",t=process.env.MYSQL_PASSWORD||"password",e=process.env.MYSQL_DATABASE||"portfolio",s=process.env.MYSQL_HOST||"localhost",i=process.env.MYSQL_PORT||"3306";return`mysql://${n}:${t}@${s}:${i}/${e}`}async function kt(n){let t=new p("\u30ED\u30FC\u30AB\u30EBMySQL\u306B\u5BFE\u3057\u3066\u30DE\u30A4\u30B0\u30EC\u30FC\u30B7\u30E7\u30F3\u3092\u5B9F\u884C\u3057\u3066\u3044\u307E\u3059");t.start();let e=H(n,"packages/db"),s=H(e,"prisma/schema/schema.prisma");if(!dt(s)){t.stop(!1,"\u30B9\u30AD\u30FC\u30DE\u30D5\u30A1\u30A4\u30EB\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093");return}let i=Et(),o=bt(s,"utf-8"),a=o.replace(/provider\s*=\s*"sqlite"/,'provider = "mysql"');xn(s,a);try{await W`DATABASE_URL=${i} bun run deploy`.cwd(e).quiet(),t.stop(!0,"\u30C7\u30FC\u30BF\u30D9\u30FC\u30B9\u30DE\u30A4\u30B0\u30EC\u30FC\u30B7\u30E7\u30F3\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F")}catch(u){wn(u,t)}finally{xn(s,o)}}async function $t(n){let t=new p("Cloudflare D1\u306B\u5BFE\u3057\u3066\u30DE\u30A4\u30B0\u30EC\u30FC\u30B7\u30E7\u30F3\u3092\u5B9F\u884C\u3057\u3066\u3044\u307E\u3059");t.start();let e=H(n,"packages/db");try{await W`bun run migrate`.cwd(e).quiet(),t.stop(!0,"\u30C7\u30FC\u30BF\u30D9\u30FC\u30B9\u30DE\u30A4\u30B0\u30EC\u30FC\u30B7\u30E7\u30F3\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F")}catch(s){wn(s,t)}}async function vn(n){if(x("\uD83D\uDD04 \u30C7\u30FC\u30BF\u30D9\u30FC\u30B9\u30DE\u30A4\u30B0\u30EC\u30FC\u30B7\u30E7\u30F3"),await yt("db"))await kt(n);else await $t(n)}var xt,wt,vt;var yn=y(()=>{v();xt=/Error:\s*([^\n]+)/,wt=/Duplicate key name/i,vt=[wt]});var{$:Sn}=globalThis.Bun;import{join as On}from"path";async function K(n,t=!0){if(x("\uD83D\uDDC4\uFE0F  Prisma\u30B9\u30AD\u30FC\u30DE\u306E\u751F\u6210"),t){let e=new p("Prisma\u30B9\u30AD\u30FC\u30DE\u3092\u751F\u6210\u3057\u3066\u3044\u307E\u3059");e.start();try{await Sn`bun run generate`.cwd(On(n,"packages/db")).quiet(),e.stop(!0,"Prisma\u30B9\u30AD\u30FC\u30DE\u306E\u751F\u6210\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F")}catch(s){e.stop(!1,"Prisma\u30B9\u30AD\u30FC\u30DE\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F"),Cn(s)}}else{d("\uD83D\uDDC4\uFE0F","Prisma\u30B9\u30AD\u30FC\u30DE\u3092\u751F\u6210\u3057\u3066\u3044\u307E\u3059...","info");try{await Sn`bun run generate`.cwd(On(n,"packages/db")).quiet(),d("","Prisma\u30B9\u30AD\u30FC\u30DE\u306E\u751F\u6210\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F","success")}catch(e){d("","Prisma\u30B9\u30AD\u30FC\u30DE\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F","warning"),Cn(e)}}}function Cn(n){if(process.env.DEBUG){console.error(n);return}let t=n,e=t?.stderr?.toString()??t?.message??String(n),s=Mt.exec(e);if(s?.[1]){let i=s[1].trim(),o=i.length>80?`${i.substring(0,77)}...`:i;c(o,"warning")}}var Mt;var En=y(()=>{v();Mt=/Error:\s*([^\n]+)/});var An={};B(An,{runWorkspace:()=>J,findRootDir:()=>A});var{$:kn}=globalThis.Bun;import{existsSync as $n}from"fs";import{join as Mn,resolve as z}from"path";function A(n=process.cwd()){let t=z(n),e=z("/");while(t!==e){let s=Mn(t,"package.json"),i=Mn(t,"turbo.json");if($n(s)&&$n(i))return t;t=z(t,"..")}return process.cwd()}async function At(){if(process.versions?.bun!==void 0)return!0;try{if(kn!==void 0)return await kn`bun --version`.quiet(),!0}catch{return!1}return!1}function Rt(n){return!n.env&&!n.install&&!n.schema&&!n.docker&&!n.migrate}function _t(n){let t=Rt(n);return{runEnv:t||n.env!==!1,runInstall:t||n.install!==!1,runSchema:t||n.schema!==!1,runDocker:t||n.docker!==!1,runMigrate:t||n.migrate!==!1,parallel:n.parallel??!0}}function Tt(){console.log(),console.log(m.default.bold(m.default.cyan("  \u256D\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256E"))),console.log(m.default.bold(m.default.cyan("  \u2502  \uD83D\uDE80 \u958B\u767A\u74B0\u5883\u306E\u30BB\u30C3\u30C8\u30A2\u30C3\u30D7\u3092\u958B\u59CB\u3057\u307E\u3059      \u2502"))),console.log(m.default.bold(m.default.cyan("  \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256F")))}function It(){console.log(),console.log(m.default.bold(m.default.green("  \u256D\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256E"))),console.log(m.default.bold(m.default.green("  \u2502  \u2705 \u30BB\u30C3\u30C8\u30A2\u30C3\u30D7\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F\uFF01            \u2502"))),console.log(m.default.bold(m.default.green("  \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256F"))),console.log(),console.log(m.default.bold("  \u6B21\u306E\u30B9\u30C6\u30C3\u30D7:")),console.log(m.default.dim("    \u2022 .env\u30D5\u30A1\u30A4\u30EB\u3092\u7DE8\u96C6\u3057\u3066\u74B0\u5883\u5909\u6570\u3092\u8A2D\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044")),console.log(m.default.dim("    \u2022 bun run dev \u3067\u958B\u767A\u30B5\u30FC\u30D0\u30FC\u3092\u8D77\u52D5\u3067\u304D\u307E\u3059")),console.log()}function qt(n){console.log(),console.error(m.default.bold(m.default.red("  \u256D\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256E"))),console.error(m.default.bold(m.default.red("  \u2502  \u2717 \u30BB\u30C3\u30C8\u30A2\u30C3\u30D7\u4E2D\u306B\u30A8\u30E9\u30FC\u304C\u767A\u751F\u3057\u307E\u3057\u305F    \u2502"))),console.error(m.default.bold(m.default.red("  \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256F"))),console.error(),console.error(m.default.red("  "),n),console.error()}async function jt(n,t){if(!t)return;if(process.env.BUN_LIFECYCLE_EVENT==="prepare"){let{logSection:s}=await Promise.resolve().then(() => (v(),mn));s("\uD83D\uDCE6 \u4F9D\u5B58\u95A2\u4FC2\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB"),d("","\u4F9D\u5B58\u95A2\u4FC2\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3092\u30B9\u30AD\u30C3\u30D7\u3057\u307E\u3057\u305F\uFF08prepare\u30B9\u30AF\u30EA\u30D7\u30C8\u304B\u3089\u5B9F\u884C\u4E2D\uFF09","info");return}await dn(n)}async function Ut(n,t,e,s){let i=!s;if(s&&(t||e)){let o=[];if(t)o.push(K(n,i));if(e)o.push(G(n,i));await Promise.all(o);return}if(t)await K(n,i);if(e)await G(n,i)}async function J(n={}){let t=A(),e=_t(n);if(Tt(),!await At())console.log(),console.error(m.default.red("  \u2717 Bun\u304C\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3055\u308C\u3066\u3044\u307E\u305B\u3093\u3002")),console.error(m.default.dim("    Bun\u3092\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3057\u3066\u304F\u3060\u3055\u3044: https://bun.sh")),process.exit(1);d("","Bun\u304C\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3055\u308C\u3066\u3044\u307E\u3059","success");try{if(e.runEnv)await F(t);if(await jt(t,e.runInstall),await Ut(t,e.runSchema,e.runDocker,e.parallel),e.runMigrate)await vn(t);It()}catch(i){qt(i),process.exit(1)}}var m;var X=y(()=>{m=L(U(),1);gn();v();bn();yn();En()});import{EventEmitter as Fn}from"events";function T(n){return n==null?[]:Array.isArray(n)?n:[n]}function Vn(n,t,e,s){var i,o=n[t],a=~s.string.indexOf(t)?e==null||e===!0?"":String(e):typeof e==="boolean"?e:~s.boolean.indexOf(t)?e==="false"?!1:e==="true"||(n._.push((i=+e,i*0===0)?i:e),!!e):(i=+e,i*0===0)?i:e;n[t]=o==null?a:Array.isArray(o)?o.concat(a):[o,a]}function Pn(n,t){n=n||[],t=t||{};var e,s,i,o,a,u={_:[]},r=0,l=0,h=0,f=n.length;let w=t.alias!==void 0,R=t.unknown!==void 0,Z=t.default!==void 0;if(t.alias=t.alias||{},t.string=T(t.string),t.boolean=T(t.boolean),w)for(e in t.alias){s=t.alias[e]=T(t.alias[e]);for(r=0;r<s.length;r++)(t.alias[s[r]]=s.concat(e)).splice(r,1)}for(r=t.boolean.length;r-- >0;){s=t.alias[t.boolean[r]]||[];for(l=s.length;l-- >0;)t.boolean.push(s[l])}for(r=t.string.length;r-- >0;){s=t.alias[t.string[r]]||[];for(l=s.length;l-- >0;)t.string.push(s[l])}if(Z){for(e in t.default)if(o=typeof t.default[e],s=t.alias[e]=t.alias[e]||[],t[o]!==void 0){t[o].push(e);for(r=0;r<s.length;r++)t[o].push(s[r])}}let N=R?Object.keys(t.alias):[];for(r=0;r<f;r++){if(i=n[r],i==="--"){u._=u._.concat(n.slice(++r));break}for(l=0;l<i.length;l++)if(i.charCodeAt(l)!==45)break;if(l===0)u._.push(i);else if(i.substring(l,l+3)==="no-"){if(o=i.substring(l+3),R&&!~N.indexOf(o))return t.unknown(i);u[o]=!1}else{for(h=l+1;h<i.length;h++)if(i.charCodeAt(h)===61)break;o=i.substring(l,h),a=i.substring(++h)||(r+1===f||(""+n[r+1]).charCodeAt(0)===45||n[++r]),s=l===2?[o]:o;for(h=0;h<s.length;h++){if(o=s[h],R&&!~N.indexOf(o))return t.unknown("-".repeat(l)+o);Vn(u,o,h+1<s.length||a,t)}}}if(Z){for(e in t.default)if(u[e]===void 0)u[e]=t.default[e]}if(w)for(e in u){s=t.alias[e]||[];while(s.length>0)u[s.shift()]=u[e]}return u}var tn=(n)=>n.replace(/[<[].+/,"").trim(),Qn=(n)=>{let t=/<([^>]+)>/g,e=/\[([^\]]+)\]/g,s=[],i=(u)=>{let r=!1,l=u[1];if(l.startsWith("..."))l=l.slice(3),r=!0;return{required:u[0].startsWith("<"),value:l,variadic:r}},o;while(o=t.exec(n))s.push(i(o));let a;while(a=e.exec(n))s.push(i(a));return s},Yn=(n)=>{let t={alias:{},boolean:[]};for(let[e,s]of n.entries()){if(s.names.length>1)t.alias[s.names[0]]=s.names.slice(1);if(s.isBoolean)if(s.negated){if(!n.some((o,a)=>{return a!==e&&o.names.some((u)=>s.names.includes(u))&&typeof o.required==="boolean"}))t.boolean.push(s.names[0])}else t.boolean.push(s.names[0])}return t},D=(n)=>{return n.sort((t,e)=>{return t.length>e.length?-1:1})[0]},nn=(n,t)=>{return n.length>=t?n:`${n}${" ".repeat(t-n.length)}`},Gn=(n)=>{return n.replace(/([a-z])-([a-z])/g,(t,e,s)=>{return e+s.toUpperCase()})},Hn=(n,t,e)=>{let s=0,i=t.length,o=n,a;for(;s<i;++s)a=o[t[s]],o=o[t[s]]=s===i-1?e:a!=null?a:!!~t[s+1].indexOf(".")||!(+t[s+1]>-1)?{}:[]},Wn=(n,t)=>{for(let e of Object.keys(t)){let s=t[e];if(s.shouldTransform){if(n[e]=Array.prototype.concat.call([],n[e]),typeof s.transformFunction==="function")n[e]=n[e].map(s.transformFunction)}}},Kn=(n)=>{let t=/([^\\\/]+)$/.exec(n);return t?t[1]:""},en=(n)=>{return n.split(".").map((t,e)=>{return e===0?Gn(t):t}).join(".")};class k extends Error{constructor(n){super(n);if(this.name=this.constructor.name,typeof Error.captureStackTrace==="function")Error.captureStackTrace(this,this.constructor);else this.stack=new Error(n).stack}}class sn{constructor(n,t,e){if(this.rawName=n,this.description=t,this.config=Object.assign({},e),n=n.replace(/\.\*/g,""),this.negated=!1,this.names=tn(n).split(",").map((s)=>{let i=s.trim().replace(/^-{1,2}/,"");if(i.startsWith("no-"))this.negated=!0,i=i.replace(/^no-/,"");return en(i)}).sort((s,i)=>s.length>i.length?1:-1),this.name=this.names[this.names.length-1],this.negated&&this.config.default==null)this.config.default=!0;if(n.includes("<"))this.required=!0;else if(n.includes("["))this.required=!1;else this.isBoolean=!0}}var zn=process.argv,Jn=`${process.platform}-${process.arch} node-${process.version}`;class I{constructor(n,t,e={},s){this.rawName=n,this.description=t,this.config=e,this.cli=s,this.options=[],this.aliasNames=[],this.name=tn(n),this.args=Qn(n),this.examples=[]}usage(n){return this.usageText=n,this}allowUnknownOptions(){return this.config.allowUnknownOptions=!0,this}ignoreOptionDefaultValue(){return this.config.ignoreOptionDefaultValue=!0,this}version(n,t="-v, --version"){return this.versionNumber=n,this.option(t,"Display version number"),this}example(n){return this.examples.push(n),this}option(n,t,e){let s=new sn(n,t,e);return this.options.push(s),this}alias(n){return this.aliasNames.push(n),this}action(n){return this.commandAction=n,this}isMatched(n){return this.name===n||this.aliasNames.includes(n)}get isDefaultCommand(){return this.name===""||this.aliasNames.includes("!")}get isGlobalCommand(){return this instanceof q}hasOption(n){return n=n.split(".")[0],this.options.find((t)=>{return t.names.includes(n)})}outputHelp(){let{name:n,commands:t}=this.cli,{versionNumber:e,options:s,helpCallback:i}=this.cli.globalCommand,o=[{body:`${n}${e?`/${e}`:""}`}];if(o.push({title:"Usage",body:`  $ ${n} ${this.usageText||this.rawName}`}),(this.isGlobalCommand||this.isDefaultCommand)&&t.length>0){let r=D(t.map((l)=>l.rawName));o.push({title:"Commands",body:t.map((l)=>{return`  ${nn(l.rawName,r.length)}  ${l.description}`}).join(`
`)}),o.push({title:"For more info, run any command with the `--help` flag",body:t.map((l)=>`  $ ${n}${l.name===""?"":` ${l.name}`} --help`).join(`
`)})}let u=this.isGlobalCommand?s:[...this.options,...s||[]];if(!this.isGlobalCommand&&!this.isDefaultCommand)u=u.filter((r)=>r.name!=="version");if(u.length>0){let r=D(u.map((l)=>l.rawName));o.push({title:"Options",body:u.map((l)=>{return`  ${nn(l.rawName,r.length)}  ${l.description} ${l.config.default===void 0?"":`(default: ${l.config.default})`}`}).join(`
`)})}if(this.examples.length>0)o.push({title:"Examples",body:this.examples.map((r)=>{if(typeof r==="function")return r(n);return r}).join(`
`)});if(i)o=i(o)||o;console.log(o.map((r)=>{return r.title?`${r.title}:
${r.body}`:r.body}).join(`

`))}outputVersion(){let{name:n}=this.cli,{versionNumber:t}=this.cli.globalCommand;if(t)console.log(`${n}/${t} ${Jn}`)}checkRequiredArgs(){let n=this.args.filter((t)=>t.required).length;if(this.cli.args.length<n)throw new k(`missing required args for command \`${this.rawName}\``)}checkUnknownOptions(){let{options:n,globalCommand:t}=this.cli;if(!this.config.allowUnknownOptions){for(let e of Object.keys(n))if(e!=="--"&&!this.hasOption(e)&&!t.hasOption(e))throw new k(`Unknown option \`${e.length>1?`--${e}`:`-${e}`}\``)}}checkOptionValue(){let{options:n,globalCommand:t}=this.cli,e=[...t.options,...this.options];for(let s of e){let i=n[s.name.split(".")[0]];if(s.required){let o=e.some((a)=>a.negated&&a.names.includes(s.name));if(i===!0||i===!1&&!o)throw new k(`option \`${s.rawName}\` value is missing`)}}}}class q extends I{constructor(n){super("@@global@@","",{},n)}}var E=Object.assign;class on extends Fn{constructor(n=""){super();this.name=n,this.commands=[],this.rawArgs=[],this.args=[],this.options={},this.globalCommand=new q(this),this.globalCommand.usage("<command> [options]")}usage(n){return this.globalCommand.usage(n),this}command(n,t,e){let s=new I(n,t||"",e,this);return s.globalCommand=this.globalCommand,this.commands.push(s),s}option(n,t,e){return this.globalCommand.option(n,t,e),this}help(n){return this.globalCommand.option("-h, --help","Display this message"),this.globalCommand.helpCallback=n,this.showHelpOnExit=!0,this}version(n,t="-v, --version"){return this.globalCommand.version(n,t),this.showVersionOnExit=!0,this}example(n){return this.globalCommand.example(n),this}outputHelp(){if(this.matchedCommand)this.matchedCommand.outputHelp();else this.globalCommand.outputHelp()}outputVersion(){this.globalCommand.outputVersion()}setParsedInfo({args:n,options:t},e,s){if(this.args=n,this.options=t,e)this.matchedCommand=e;if(s)this.matchedCommandName=s;return this}unsetMatchedCommand(){this.matchedCommand=void 0,this.matchedCommandName=void 0}parse(n=zn,{run:t=!0}={}){if(this.rawArgs=n,!this.name)this.name=n[1]?Kn(n[1]):"cli";let e=!0;for(let i of this.commands){let o=this.mri(n.slice(2),i),a=o.args[0];if(i.isMatched(a)){e=!1;let u=E(E({},o),{args:o.args.slice(1)});this.setParsedInfo(u,i,a),this.emit(`command:${a}`,i)}}if(e){for(let i of this.commands)if(i.name===""){e=!1;let o=this.mri(n.slice(2),i);this.setParsedInfo(o,i),this.emit("command:!",i)}}if(e){let i=this.mri(n.slice(2));this.setParsedInfo(i)}if(this.options.help&&this.showHelpOnExit)this.outputHelp(),t=!1,this.unsetMatchedCommand();if(this.options.version&&this.showVersionOnExit&&this.matchedCommandName==null)this.outputVersion(),t=!1,this.unsetMatchedCommand();let s={args:this.args,options:this.options};if(t)this.runMatchedCommand();if(!this.matchedCommand&&this.args[0])this.emit("command:*");return s}mri(n,t){let e=[...this.globalCommand.options,...t?t.options:[]],s=Yn(e),i=[],o=n.indexOf("--");if(o>-1)i=n.slice(o+1),n=n.slice(0,o);let a=Pn(n,s);a=Object.keys(a).reduce((f,w)=>{return E(E({},f),{[en(w)]:a[w]})},{_:[]});let u=a._,r={"--":i},l=t&&t.config.ignoreOptionDefaultValue?t.config.ignoreOptionDefaultValue:this.globalCommand.config.ignoreOptionDefaultValue,h=Object.create(null);for(let f of e){if(!l&&f.config.default!==void 0)for(let w of f.names)r[w]=f.config.default;if(Array.isArray(f.config.type)){if(h[f.name]===void 0)h[f.name]=Object.create(null),h[f.name].shouldTransform=!0,h[f.name].transformFunction=f.config.type[0]}}for(let f of Object.keys(a))if(f!=="_"){let w=f.split(".");Hn(r,w,a[f]),Wn(r,h)}return{args:u,options:r}}runMatchedCommand(){let{args:n,options:t,matchedCommand:e}=this;if(!e||!e.commandAction)return;e.checkUnknownOptions(),e.checkOptionValue(),e.checkRequiredArgs();let s=[];return e.args.forEach((i,o)=>{if(i.variadic)s.push(n.slice(o));else s.push(n[o])}),s.push(t),e.commandAction.apply(this,s)}}var rn=(n="")=>new on(n);X();v();var{$:Ft,spawn:Vt}=globalThis.Bun;import{existsSync as Pt,readdirSync as Qt,readFileSync as Yt}from"fs";import{join as Rn}from"path";var Gt=/Error:\s*([^\n]+)/;async function Ht(n){try{return(await Ft`docker ps --filter name=^${n}$ --format {{.Names}}`.quiet()).stdout.toString().trim()===n}catch{return!1}}function Wt(n){let t=n,e=t?.stderr?.toString()??t?.message??String(n);return Gt.exec(e)?.[1]?.trim()??null}function Kt(n){return n.length>80?`${n.substring(0,77)}...`:n}function zt(n,t){if(t.stop(!1,"\u30B7\u30FC\u30C9\u30C7\u30FC\u30BF\u306E\u6295\u5165\u306B\u5931\u6557\u3057\u307E\u3057\u305F"),process.env.DEBUG){console.error(n);return}let e=Wt(n);if(e)c(Kt(e),"warning")}async function Jt(n){let t=new p("\u30ED\u30FC\u30AB\u30EBMySQL\u306B\u30B7\u30FC\u30C9\u30C7\u30FC\u30BF\u3092\u6295\u5165\u3057\u3066\u3044\u307E\u3059");t.start();let e=Rn(n,".docker/db/seed");if(!Pt(e)){t.stop(!1,"\u30B7\u30FC\u30C9\u30C7\u30A3\u30EC\u30AF\u30C8\u30EA\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093");return}let s=Qt(e).filter((r)=>r.endsWith(".sql")).sort((r,l)=>r.localeCompare(l)).map((r)=>Rn(e,r));if(s.length===0){t.stop(!1,"\u30B7\u30FC\u30C9\u30D5\u30A1\u30A4\u30EB\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093");return}let i=process.env.MYSQL_USER||"user",o=process.env.MYSQL_PASSWORD||"password",a=process.env.MYSQL_DATABASE||"portfolio",u="db";try{for(let r of s){let l=r.split("/").pop()||r;c(`\u5B9F\u884C\u4E2D: ${l}`,"info");let h=Yt(r,"utf-8"),f=Vt(["docker","exec","-i",u,"mysql","-u",i,`-p${o}`,a],{stdin:"pipe",stdout:"pipe",stderr:"pipe"});if(f.stdin.write(h),f.stdin.end(),await f.exited,f.exitCode!==0){let w=await f.stderr.text();throw new Error(`Failed to execute seed file ${l}: ${w}`)}}t.stop(!0,"\u30B7\u30FC\u30C9\u30C7\u30FC\u30BF\u306E\u6295\u5165\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F")}catch(r){throw zt(r,t),r}}async function _n(n){if(x("\uD83C\uDF31 \u30B7\u30FC\u30C9\u30C7\u30FC\u30BF\u306E\u6295\u5165"),!await Ht("db")){c("MySQL\u30B3\u30F3\u30C6\u30CA\u304C\u8D77\u52D5\u3057\u3066\u3044\u307E\u305B\u3093","warning"),c("\u30B3\u30F3\u30C6\u30CA\u3092\u8D77\u52D5\u3057\u3066\u304B\u3089\u518D\u5EA6\u5B9F\u884C\u3057\u3066\u304F\u3060\u3055\u3044","info");return}await Jt(n)}var O=rn("workspace");O.command("setup","\u958B\u767A\u74B0\u5883\u306E\u30BB\u30C3\u30C8\u30A2\u30C3\u30D7\u3092\u5B9F\u884C\u3057\u307E\u3059").option("--env","\u74B0\u5883\u8A2D\u5B9A\u306E\u307F\u5B9F\u884C").option("--install","\u4F9D\u5B58\u95A2\u4FC2\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u306E\u307F\u5B9F\u884C").option("--schema","Prisma\u30B9\u30AD\u30FC\u30DE\u306E\u751F\u6210\u306E\u307F\u5B9F\u884C").option("--docker","Docker\u30A4\u30E1\u30FC\u30B8\u306E\u30D3\u30EB\u30C9\u306E\u307F\u5B9F\u884C").option("--migrate","\u30C7\u30FC\u30BF\u30D9\u30FC\u30B9\u30DE\u30A4\u30B0\u30EC\u30FC\u30B7\u30E7\u30F3\u306E\u307F\u5B9F\u884C").option("--no-parallel","\u4E26\u5217\u5B9F\u884C\u3092\u7121\u52B9\u5316").action(async(n)=>{let t={env:n.env!==void 0,install:n.install!==void 0,schema:n.schema!==void 0,docker:n.docker!==void 0,migrate:n.migrate!==void 0,parallel:!n["no-parallel"]};await J(t)});O.command("seed","\u30B7\u30FC\u30C9\u30C7\u30FC\u30BF\u3092\u6295\u5165\u3057\u307E\u3059").action(async()=>{let n=A();await _n(n)});O.command("*","\u958B\u767A\u74B0\u5883\u306E\u30BB\u30C3\u30C8\u30A2\u30C3\u30D7\u3092\u5B9F\u884C\u3057\u307E\u3059").action(async()=>{let{runWorkspace:n}=await Promise.resolve().then(() => (X(),An));await n()});O.help();O.version("1.0.1");O.parse();
